---
layout: single
title:  "7ì°¨ê³¼ì œ ë¨¸ì‹ ëŸ¬ë‹ëª¨ë¸ì„ ì´ìš©í•œ wepappêµ¬í˜„"
categories: coding
tag: [python, blog, jekyll]
toc: true
author_profile: false
---

<head>
  <style>
    table.dataframe {
      white-space: normal;
      width: 100%;
      height: 240px;
      display: block;
      overflow: auto;
      font-family: Arial, sans-serif;
      font-size: 0.9rem;
      line-height: 20px;
      text-align: center;
      border: 0px !important;
    }

    table.dataframe th {
      text-align: center;
      font-weight: bold;
      padding: 8px;
    }

    table.dataframe td {
      text-align: center;
      padding: 8px;
    }

    table.dataframe tr:hover {
      background: #b8d1f3; 
    }

    .output_prompt {
      overflow: auto;
      font-size: 0.9rem;
      line-height: 1.45;
      border-radius: 0.3rem;
      -webkit-overflow-scrolling: touch;
      padding: 0.8rem;
      margin-top: 0;
      margin-bottom: 15px;
      font: 1rem Consolas, "Liberation Mono", Menlo, Courier, monospace;
      color: $code-text-color;
      border: solid 1px $border-color;
      border-radius: 0.3rem;
      word-break: normal;
      white-space: pre;
    }

  .dataframe tbody tr th:only-of-type {
      vertical-align: middle;
  }

  .dataframe tbody tr th {
      vertical-align: top;
  }

  .dataframe thead th {
      text-align: center !important;
      padding: 8px;
  }

  .page__content p {
      margin: 0 0 0px !important;
  }

  .page__content p > strong {
    font-size: 0.8rem !important;
  }

  </style>
</head>


## MLëª¨ë¸ì„ ì´ìš©í•˜ì—¬ ì›¹ì•± êµ¬ì¶•í•˜ê¸°





NUFORC ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ê°€ì ¸ì˜¨ ì§€ë‚œ 100ë…„ê°„ UFO ëª©ê²© ë³´ê³ ì˜ ë‚´ìš©ì„ ê¸°ë°˜ìœ¼ë¡œ ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì„ í•™ìŠµì‹œí‚¬ ê²ƒì´ë‹¤.



ì—¬ê¸°ì„œëŠ” í›ˆë ¨ëœ ëª¨ë¸ì„ pickel(í”¼í´ë§)í•˜ëŠ” ë²•

í”Œë¼ìŠ¤í¬ì•±ì—ì„œ í•´ë‹¹ ëª¨ë¸ì„ ì‚¬ìš©í•˜ëŠ” ë²•ì„ ë°°ìš¸ê²ƒì…ë‹ˆë‹¤.



ë°ì´í„° ì •ë¦¬ ë° ëª¨ë¸ í›ˆë ¨ì— ëŒ€í•´ ë…¸íŠ¸ë¶ì„ ê³„ì† ì‚¬ìš©í•  ì˜ˆì •ì´ì§€ë§Œ, ëª¨ë¸ì„ 'ì‹¤ì „'ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë°©ë²•, ì¦‰ ì›¹ ì•±ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì„ ì‚´í´ë³¼ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.



ì´ë¥¼ ìœ„í•´ Flaskë¥¼ ì‚¬ìš©í•˜ì—¬ ì›¹ ì•±ì„ êµ¬ì¶•í•´ì•¼ í•©ë‹ˆë‹¤.


ë¨¸ì‹ ëŸ¬ë‹ëª¨ë¸ì„ ì‚¬ìš©í•˜ëŠ” ì›¹ ì•±ì„ ë§Œë“œëŠ” ë°©ë²•ì—ëŠ” ì—¬ëŸ¬ ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤. ì›¹ ì•„í‚¤í…ì²˜ì— ë”°ë¼ ëª¨ë¸ í•™ìŠµ ë°©ë²•ì´ ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 



ë°ì´í„° ê³¼í•™ ê·¸ë£¹ì—ì„œ í•™ìŠµí•œ ëª¨ë¸ì„ ì•±ì—ì„œ ì‚¬ìš©í•˜ë„ë¡ ìš”ì²­ ë°›ì•˜ë‹¤ê³  ìƒìƒí•´ë³´ì„¸ìš”.



#### ê³ ë ¤ ì‚¬í•­



- ì›¹ ì•±ì¸ê°€ ëª¨ë°”ì¼ ì•±ì¸ê°€? ëª¨ë°”ì¼ ì•±ì´ë‚˜ IoT í™˜ê²½ì—ì„œ ëª¨ë¸ì„ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ê²½ìš°, TensorFlow Liteë¥¼ ì‚¬ìš©í•˜ì—¬ Android ë˜ëŠ” iOS ì•±ì—ì„œ ëª¨ë¸ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- ëª¨ë¸ì€ ì–´ë””ì— ìœ„ì¹˜í•˜ê²Œ ë ê¹Œìš”? í´ë¼ìš°ë“œì—ì„œ ê´€ë¦¬í• ê¹Œìš” ì•„ë‹ˆë©´ ë¡œì»¬ì— ì €ì¥í• ê¹Œìš”?

- ì˜¤í”„ë¼ì¸ ì§€ì›ì´ í•„ìš”í•œê°€ìš”? ì•±ì´ ì˜¤í”„ë¼ì¸ì—ì„œ ì‘ë™í•´ì•¼ í•˜ëŠ” ê²½ìš°ëŠ” ì–´ë–¤ê°€ìš”?

- ëª¨ë¸ì„ í•™ìŠµí•˜ëŠ” ë° ì‚¬ìš©í•œ ê¸°ìˆ ì€ ë¬´ì—‡ì¸ê°€ìš”? ì„ íƒí•œ ê¸°ìˆ ì— ë”°ë¼ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ë„êµ¬ê°€ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

  - TensorFlowë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°, TensorFlow.jsë¥¼ ì‚¬ìš©í•˜ì—¬ TensorFlow ëª¨ë¸ì„ ì›¹ ì•±ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ë³€í™˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

  - PyTorchë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°, ONNX(Open Neural Network Exchange) í˜•ì‹ìœ¼ë¡œ ë‚´ë³´ë‚´ ì›¹ ì•±ì—ì„œ Onnx Runtimeì„ ì‚¬ìš©í•˜ì—¬ JavaScript ì›¹ ì•±ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

  - Lobe.aië‚˜ Azure Custom Visionì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°, ì´ëŸ¬í•œ ML SaaS(ì†Œí”„íŠ¸ì›¨ì–´ ì„œë¹„ìŠ¤) ì‹œìŠ¤í…œì„ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ì„ ë‚´ë³´ë‚´ í´ë¼ìš°ë“œì—ì„œ ì˜¨ë¼ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì˜í•´ ì¿¼ë¦¬ë  ìˆ˜ ìˆëŠ” ë§ì¶¤í˜• APIë¥¼ êµ¬ì¶•í•˜ëŠ” ë“± ì—¬ëŸ¬ í”Œë«í¼ì— ëª¨ë¸ì„ ë‚´ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- ë˜í•œ Flask ì›¹ ì•± ì „ì²´ë¥¼ êµ¬ì¶•í•˜ì—¬ ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ ëª¨ë¸ ìì²´ë¥¼ í•™ìŠµì‹œí‚¬ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì´ê²ƒì€ JavaScript ì»¨í…ìŠ¤íŠ¸ì—ì„œ TensorFlow.jsë¥¼ ì‚¬ìš©í•˜ì—¬ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


ìš°ë¦¬ëŠ” Python ê¸°ë°˜ ë…¸íŠ¸ë¶ì„ ì‚¬ìš©í•˜ê³  ìˆê¸° ë•Œë¬¸ì—, ì´ëŸ¬í•œ ë…¸íŠ¸ë¶ì—ì„œ í•™ìŠµëœ ëª¨ë¸ì„ Pythonìœ¼ë¡œ êµ¬ì¶•ëœ ì›¹ ì•±ì—ì„œ ì½ì„ ìˆ˜ ìˆëŠ” í˜•ì‹ìœ¼ë¡œ ë‚´ë³´ë‚´ëŠ” ë‹¨ê³„ì— ëŒ€í•´ ì‚´í´ë³¼ ê²ƒì…ë‹ˆë‹¤.


### ë„êµ¬



ì´ë²ˆ ì‘ì—…ì—ì„œëŠ” Flaskì™€ Pickleì´ë¼ëŠ” ë‘ ê°€ì§€ ë„êµ¬ê°€ í•„ìš”í•©ë‹ˆë‹¤. ë‘˜ ë‹¤ Pythonì—ì„œ ì‹¤í–‰ë©ë‹ˆë‹¤.

âœ… Flaskë€? FlaskëŠ” ê·¸ ìƒì„±ìë“¤ì— ì˜í•´ 'ë§ˆì´í¬ë¡œ í”„ë ˆì„ì›Œí¬'ë¡œ ì •ì˜ë˜ë©°, Pythonì„ ì‚¬ìš©í•˜ì—¬ ì›¹ í”„ë ˆì„ì›Œí¬ì˜ ê¸°ë³¸ ê¸°ëŠ¥ê³¼ í…œí”Œë¦¿ ì—”ì§„ì„ ì œê³µí•˜ì—¬ ì›¹ í˜ì´ì§€ë¥¼ êµ¬ì¶•í•©ë‹ˆë‹¤. Flaskë¡œ êµ¬ì¶•í•˜ëŠ” ë°©ë²•ì„ ì—°ìŠµí•˜ê¸° ìœ„í•´ ì´ í•™ìŠµ ëª¨ë“ˆì„ ì‚´í´ë³´ì„¸ìš”.



âœ… Pickleì´ë€? Pickleì€ Python ëª¨ë“ˆë¡œ, Python ê°ì²´ êµ¬ì¡°ë¥¼ ì§ë ¬í™”í•˜ê³  ì—­ ì§ë ¬í™”í•©ë‹ˆë‹¤. ëª¨ë¸ì„ 'pickle'í•  ë•Œ, í•´ë‹¹ ëª¨ë¸ì˜ êµ¬ì¡°ë¥¼ ì§ë ¬í™”í•˜ê±°ë‚˜ í¼ì³ì„œ ì›¹ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ Pickleì€ ë‚´ì¬ì ìœ¼ë¡œ ì•ˆì „í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì—, íŒŒì¼ì„ 'un-pickle'í•˜ë„ë¡ ìš”êµ¬ë˜ëŠ” ê²½ìš° ì£¼ì˜í•´ì•¼ í•©ë‹ˆë‹¤. Pickle íŒŒì¼ì˜ ì ‘ë¯¸ì‚¬ëŠ” .pklì…ë‹ˆë‹¤.


### ì—°ìŠµ



ì´ë²ˆ ìˆ˜ì—…ì—ì„œëŠ” NUFORC (The National UFO Reporting Center)ì—ì„œ ìˆ˜ì§‘í•œ 80,000ê±´ì˜ UFO ê´€ì¸¡ ë°ì´í„°ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ì´ ë°ì´í„°ì—ëŠ” ë‹¤ìŒê³¼ ê°™ì€ í¥ë¯¸ë¡œìš´ UFO ê´€ì¸¡ ê¸°ë¡ì´ í¬í•¨ë©ë‹ˆë‹¤.



ê¸´ ì˜ˆì‹œ : "ë°¤ì— í’€ë°­ì— ë¹„ì¶°ì§€ëŠ” ë¹”ì—ì„œ ë‚¨ìê°€ ë“±ì¥í•˜ë©°, í…ì‚¬ìŠ¤ ì¸ìŠ¤íŠ¸ë£¨ë¨¼íŠ¸ ì£¼ì°¨ì¥ìœ¼ë¡œ ë‹¬ë ¤ê°€ëŠ” ëª¨ìŠµì„ ë³´ì¸ë‹¤."

ì§§ì€ ì˜ˆì‹œ : "ë¹›ë“¤ì´ ìš°ë¦¬ë¥¼ ì«“ì•„ê°”ë‹¤."

ufos.csv ìŠ¤í”„ë ˆë“œì‹œíŠ¸ì—ëŠ” ê´€ì¸¡ì´ ë°œìƒí•œ ë„ì‹œ, ì£¼, êµ­ê°€, ë¬¼ì²´ì˜ ëª¨ì–‘, ìœ„ë„ ë° ê²½ë„ì™€ ê´€ë ¨ëœ ì—´ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.



ì´ ë ˆìŠ¨ì— í¬í•¨ëœ ë¹ˆ ë…¸íŠ¸ë¶ì—ì„œëŠ” ë‹¤ìŒì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.


1. íŒë‹¤ìŠ¤(pandas), ë§·í”Œë¡¯ë¦½(matplotlib), ë„˜íŒŒì´(numpy)ë¥¼ import í•˜ê³ , ufos ìŠ¤í”„ë ˆë“œì‹œíŠ¸ë¥¼ import 



```python
import pandas as pd
import numpy as np

ufos = pd.read_csv('https://raw.githubusercontent.com/microsoft/ML-For-Beginners/main/3-Web-App/1-Web-App/data/ufos.csv')
ufos.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
      <th>city</th>
      <th>state</th>
      <th>country</th>
      <th>shape</th>
      <th>duration (seconds)</th>
      <th>duration (hours/min)</th>
      <th>comments</th>
      <th>date posted</th>
      <th>latitude</th>
      <th>longitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10/10/1949 20:30</td>
      <td>san marcos</td>
      <td>tx</td>
      <td>us</td>
      <td>cylinder</td>
      <td>2700.0</td>
      <td>45 minutes</td>
      <td>This event took place in early fall around 194...</td>
      <td>4/27/2004</td>
      <td>29.883056</td>
      <td>-97.941111</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10/10/1949 21:00</td>
      <td>lackland afb</td>
      <td>tx</td>
      <td>NaN</td>
      <td>light</td>
      <td>7200.0</td>
      <td>1-2 hrs</td>
      <td>1949 Lackland AFB&amp;#44 TX.  Lights racing acros...</td>
      <td>12/16/2005</td>
      <td>29.384210</td>
      <td>-98.581082</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10/10/1955 17:00</td>
      <td>chester (uk/england)</td>
      <td>NaN</td>
      <td>gb</td>
      <td>circle</td>
      <td>20.0</td>
      <td>20 seconds</td>
      <td>Green/Orange circular disc over Chester&amp;#44 En...</td>
      <td>1/21/2008</td>
      <td>53.200000</td>
      <td>-2.916667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10/10/1956 21:00</td>
      <td>edna</td>
      <td>tx</td>
      <td>us</td>
      <td>circle</td>
      <td>20.0</td>
      <td>1/2 hour</td>
      <td>My older brother and twin sister were leaving ...</td>
      <td>1/17/2004</td>
      <td>28.978333</td>
      <td>-96.645833</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10/10/1960 20:00</td>
      <td>kaneohe</td>
      <td>hi</td>
      <td>us</td>
      <td>light</td>
      <td>900.0</td>
      <td>15 minutes</td>
      <td>AS a Marine 1st Lt. flying an FJ4B fighter/att...</td>
      <td>1/22/2004</td>
      <td>21.418056</td>
      <td>-157.803611</td>
    </tr>
  </tbody>
</table>
</div>


2. ufos ë°ì´í„°ë¥¼ ìƒˆë¡œìš´ ì œëª©ì„ ê°–ëŠ” ì‘ì€ ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ ë³€í™˜í•˜ì„¸ìš”. Country í•„ë“œì—ì„œ ê³ ìœ í•œ ê°’ì„ í™•ì¸í•˜ì„¸ìš”.



```python
ufos = pd.DataFrame({'Seconds': ufos['duration (seconds)'], 'Country': ufos['country'],'Latitude': ufos['latitude'],'Longitude': ufos['longitude']})

ufos.Country.unique()
```

<pre>
array(['us', nan, 'gb', 'ca', 'au', 'de'], dtype=object)
</pre>
3. ì´ì œ, ë„ ê°’(null values)ì„ ì œê±°í•˜ê³  1-60ì´ˆ ì‚¬ì´ì˜ ëª©ê²© ë³´ê³ ì„œë§Œ ê°€ì ¸ì™€ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•  í•„ìš”ê°€ ìˆìŠµë‹ˆë‹¤:



```python
ufos.dropna(inplace=True)

ufos = ufos[(ufos['Seconds'] >= 1) & (ufos['Seconds'] <= 60)]

ufos.info()
```

<pre>
<class 'pandas.core.frame.DataFrame'>
Int64Index: 25863 entries, 2 to 80330
Data columns (total 4 columns):
 #   Column     Non-Null Count  Dtype  
---  ------     --------------  -----  
 0   Seconds    25863 non-null  float64
 1   Country    25863 non-null  object 
 2   Latitude   25863 non-null  float64
 3   Longitude  25863 non-null  float64
dtypes: float64(3), object(1)
memory usage: 1010.3+ KB
</pre>
4. Scikit-learnì˜ LabelEncoder ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ê°€ì ¸ì™€ì„œ êµ­ê°€ì˜ í…ìŠ¤íŠ¸ ê°’ì„ ìˆ«ìë¡œ ë³€í™˜í•˜ì„¸ìš”. 



âœ… LabelEncoderëŠ” ë°ì´í„°ë¥¼ ì•ŒíŒŒë²³ìˆœìœ¼ë¡œ ì¸ì½”ë”©í•©ë‹ˆë‹¤.



```python
from sklearn.preprocessing import LabelEncoder

ufos['Country'] = LabelEncoder().fit_transform(ufos['Country'])

ufos.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Seconds</th>
      <th>Country</th>
      <th>Latitude</th>
      <th>Longitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>20.0</td>
      <td>3</td>
      <td>53.200000</td>
      <td>-2.916667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>20.0</td>
      <td>4</td>
      <td>28.978333</td>
      <td>-96.645833</td>
    </tr>
    <tr>
      <th>14</th>
      <td>30.0</td>
      <td>4</td>
      <td>35.823889</td>
      <td>-80.253611</td>
    </tr>
    <tr>
      <th>23</th>
      <td>60.0</td>
      <td>4</td>
      <td>45.582778</td>
      <td>-122.352222</td>
    </tr>
    <tr>
      <th>24</th>
      <td>3.0</td>
      <td>3</td>
      <td>51.783333</td>
      <td>-0.783333</td>
    </tr>
  </tbody>
</table>
</div>


## ì—°ìŠµ - ëª¨ë¸ êµ¬ì¶•



ì´ì œ ëª¨ë¸ì„ í›ˆë ¨ì‹œí‚¤ê¸° ìœ„í•´ ë°ì´í„°ë¥¼ í›ˆë ¨ ë° í…ŒìŠ¤íŠ¸ ê·¸ë£¹ìœ¼ë¡œ ë‚˜ëˆ„ì–´ì•¼ í•©ë‹ˆë‹¤.



1. Seconds, Latitude ë° Longitudeì™€ ê°™ì€ ì„¸ ê°€ì§€ ê¸°ëŠ¥ì„ X ë²¡í„°ë¡œ ì„ íƒí•˜ê³ , y ë²¡í„°ëŠ” Countryê°€ ë©ë‹ˆë‹¤. Seconds, Latitude ë° Longitudeì„ ì…ë ¥í•˜ë©´ êµ­ê°€ IDë¥¼ ë°˜í™˜í•  ìˆ˜ ìˆë„ë¡í•˜ë ¤ê³  í•©ë‹ˆë‹¤.



```python
from sklearn.model_selection import train_test_split

Selected_features = ['Seconds','Latitude','Longitude']

X = ufos[Selected_features]
y = ufos['Country']

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)
```

2. ë¡œì§€ìŠ¤í‹± íšŒê·€ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ì„ í›ˆë ¨í•˜ì„¸ìš”:


```python

from sklearn.metrics import accuracy_score, classification_report

from sklearn.linear_model import LogisticRegression

model = LogisticRegression()

model.fit(X_train, y_train)

predictions = model.predict(X_test)



print(classification_report(y_test, predictions))

print('Predicted labels: ', predictions)

print('Accuracy: ', accuracy_score(y_test, predictions))

```


ì •í™•ë„ê°€ ë‚˜ì˜ì§€ ì•ŠìŠµë‹ˆë‹¤ (ì•½ 95% ì •ë„), Countryì™€ Latitude/Longitudeê°€ ìƒê´€ ê´€ê³„ê°€ ìˆê¸° ë•Œë¬¸ì— ì˜ˆìƒí•œ ê²°ê³¼ì…ë‹ˆë‹¤.



í•˜ì§€ë§Œ ìƒì„±í•œ ëª¨ë¸ì€ Latitudeì™€ Longitudeì—ì„œ Countryë¥¼ ì¶”ë¡ í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ í˜ì‹ ì ì´ì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì •ë¦¬í•˜ê³  ë‚´ë³´ë‚¸ ì›ì‹œ ë°ì´í„°ì—ì„œ í›ˆë ¨í•œ ë‹¤ìŒ ì´ ëª¨ë¸ì„ ì›¹ ì•±ì—ì„œ ì‚¬ìš©í•´ë³´ëŠ” ê²ƒì€ ì¢‹ì€ ì—°ìŠµì´ ë  ê²ƒì…ë‹ˆë‹¤.


### ì—°ìŠµ - ëª¨ë¸ í”¼í´ë§





ì´ì œ ëª¨ë¸ì„ í”¼í´ë§í• ê²ë‹ˆë‹¤. Pickleë¡œ ì €ì¥í•œ í›„ Pickleëœ ëª¨ë¸ì„ ë¡œë“œí•˜ê³ , ì´ˆ(second), ìœ„ë„(latitude), ê²½ë„(longitude) ê°’ì´ í¬í•¨ëœ ìƒ˜í”Œ ë°ì´í„° ë°°ì—´ì„ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ì„ í…ŒìŠ¤íŠ¸í•´ ë³´ì„¸ìš”.


```python

import pickle

model_filename = 'ufo-model.pkl'

pickle.dump(model, open(model_filename,'wb'))



model = pickle.load(open('ufo-model.pkl','rb'))

print(model.predict([[50,44,-12]]))

```


### ì—°ìŠµ - í”Œë¼ìŠ¤í¬ì•± êµ¬ì¶•





ì´ì œ ëª¨ë¸ì„ í˜¸ì¶œí•˜ê³  ë¹„ìŠ·í•œ ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ì§€ë§Œ ë” ì‹œê°ì ìœ¼ë¡œ ë³´ê¸° ì¢‹ì€ ë°©ì‹ìœ¼ë¡œ ë°˜í™˜í•  ìˆ˜ ìˆëŠ” Flask ì•±ì„ êµ¬ì¶•í•  ì°¨ë¡€ì…ë‹ˆë‹¤.



1. ìš°ì„  ufo-model.pkl íŒŒì¼ì´ ìˆëŠ” notebook.ipynb íŒŒì¼ ì˜†ì— web-appì´ë¼ëŠ” ì´ë¦„ì˜ í´ë”ë¥¼ ë§Œë“œì„¸ìš”.



1. ê·¸ í´ë” ì•ˆì— static í´ë”ì™€ ê·¸ ì•ˆì— css í´ë”, ê·¸ë¦¬ê³  templates í´ë”ë¥¼ ë§Œë“œì„¸ìš”. ì´ì œ ë‹¤ìŒ íŒŒì¼ê³¼ ë””ë ‰í† ë¦¬ê°€ ìˆì–´ì•¼ í•©ë‹ˆë‹¤:


~~~

web-app/

  static/

    css/

  templates/

notebook.ipynb

ufo-model.pkl

~~~


3. web-app í´ë”ì— ìƒì„±í•´ì•¼í•˜ëŠ” ì²« ë²ˆì§¸ íŒŒì¼ì€ requirements.txt íŒŒì¼ì…ë‹ˆë‹¤. JavaScript ì•±ì˜ package.jsonê³¼ ê°™ì´ ì´ íŒŒì¼ì€ ì•±ì—ì„œ í•„ìš”í•œ ì¢…ì†ì„±ì„ ë‚˜ì—´í•©ë‹ˆë‹¤. requirements.txtì— ë‹¤ìŒ ë¼ì¸ì„ ì¶”ê°€í•˜ì„¸ìš”.


~~~

scikit-learn

pandas

numpy

flask

~~~


4. ì´ì œ ì›¹ ì•±ì„ íƒìƒ‰í•˜ì—¬ ì´ íŒŒì¼ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.


```python

cd web-app

```


5. í„°ë¯¸ë„ì— pip installì„ ì…ë ¥í•˜ì—¬ ìš”êµ¬ ì‚¬í•­ì— ë‚˜ì—´ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.


```

pip install -r requirements.txt

```


6. ì´ì œ ì•±ì„ ì™„ì„±í•˜ê¸°ìœ„í•´ 3ê°œì˜ íŒŒì¼ì„ ë” ë§Œë“¤ì¤€ë¹„ê°€ ëœê²ë‹ˆë‹¤.

    1. ë£¨íŠ¸í´ë”ì— app.py ìƒì„±

    2. í…œí”Œë¦¿ ë””ë ‰í† ë¦¬ì— index.html ìƒì„±

    3. static/css ë””ë ‰í† ë¦¬ì— styles.css ìƒì„±



7. ëª‡ ê°€ì§€ ìŠ¤íƒ€ì¼ë¡œ styles.css íŒŒì¼ì„ ë§Œë“­ë‹ˆë‹¤.


```css

body {

	width: 100%;

	height: 100%;

	font-family: 'Helvetica';

	background: black;

	color: #fff;

	text-align: center;

	letter-spacing: 1.4px;

	font-size: 30px;

}



input {

	min-width: 150px;

}



.grid {

	width: 300px;

	border: 1px solid #2d2d2d;

	display: grid;

	justify-content: center;

	margin: 20px auto;

}



.box {

	color: #fff;

	background: #2d2d2d;

	padding: 12px;

	display: inline-block;

}

```


8. index.html íŒŒì¼ë„ ë‹¤ìŒê³¼ ê°™ì´ ë¹Œë“œí•©ë‹ˆë‹¤.


```html

<!DOCTYPE html>

<html>

  <head>

    <meta charset="UTF-8">

    <title>ğŸ›¸ UFO Appearance Prediction! ğŸ‘½</title>

    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">

  </head>



  <body>

    <div class="grid">



      <div class="box">



        <p>According to the number of seconds, latitude and longitude, which country is likely to have reported seeing a UFO?</p>



        <form action="{{ url_for('predict')}}" method="post">

          <input type="number" name="seconds" placeholder="Seconds" required="required" min="0" max="60" />

          <input type="text" name="latitude" placeholder="Latitude" required="required" />

          <input type="text" name="longitude" placeholder="Longitude" required="required" />

          <button type="submit" class="btn">Predict country where the UFO is seen</button>

        </form>



        <p>{{ prediction_text }}</p>



      </div>



    </div>



  </body>

</html>

```


ì´ íŒŒì¼ì˜ í…œí”Œë¦¿ì„ ì‚´í´ë³´ì„¸ìš”. ì˜ˆì¸¡ í…ìŠ¤íŠ¸ì™€ ê°™ì´ ì•±ì—ì„œ ì œê³µë˜ëŠ” ë³€ìˆ˜ ì£¼ìœ„ì— 'mustache' êµ¬ë¬¸ {{}}ì´ ìˆìŠµë‹ˆë‹¤. ë˜í•œ /predict ê²½ë¡œë¡œ ì˜ˆì¸¡ì„ ê²Œì‹œí•˜ëŠ” ì–‘ì‹ì´ ìˆìŠµë‹ˆë‹¤.



ë§ˆì§€ë§‰ìœ¼ë¡œ, ëª¨ë¸ì˜ ì‚¬ìš©ê³¼ ì˜ˆì¸¡ í‘œì‹œë¥¼ ì£¼ë„í•˜ëŠ” Python íŒŒì¼ì„ ë¹Œë“œí•  ì¤€ë¹„ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.


9. app.pyë¥¼ ì‘ì„±í•˜ì„¸ìš”

```python

import numpy as np

from flask import Flask, request, render_template

import pickle



app = Flask(__name__)



model = pickle.load(open("./ufo-model.pkl", "rb"))





@app.route("/")

def home():

    return render_template("index.html")





@app.route("/predict", methods=["POST"])

def predict():



    int_features = [int(x) for x in request.form.values()]

    final_features = [np.array(int_features)]

    prediction = model.predict(final_features)



    output = prediction[0]



    countries = ["Australia", "Canada", "Germany", "UK", "US"]



    return render_template(

        "index.html", prediction_text="Likely country: {}".format(countries[output])

    )





if __name__ == "__main__":

    app.run(debug=True)

    

```


app.pyíŒŒì¼ì„ ì‹¤í–‰í•˜ë©´ ì›¹í˜ì´ì§€ì˜ ì£¼ì†Œê°€ ë‚˜ì˜¤ë©° ê·¸ ì£¼ì†Œë¡œ ì›¹ì— ì ‘ì†í•˜ë©´ ì‹¤í–‰ëœë‹¤.




app.py íŒŒì¼ì˜ êµ¬ì„±ì„ ì‚´í´ë³´ì.



1. ì²«ì§¸ë¡œ, ì˜ì¡´ì„±ì´ ë¡œë“œë˜ê³  ì•±ì´ ì‹œì‘ëœë‹¤.

2. ê·¸ ë‹¤ìŒ, ëª¨ë¸ì´ ê°€ì ¸ì™€ì§„ë‹¤.

3. ê·¸ë¦¬ê³  home routeì—ì„œ index.htmlì´ ë Œë”ë§ëœë‹¤.



/predict routeì—ì„œ formì´ ì œì¶œë˜ë©´ ì—¬ëŸ¬ ì‘ì—…ì´ ìˆ˜í–‰ëœë‹¤:



1. í¼ ë³€ìˆ˜ê°€ ìˆ˜ì§‘ë˜ê³  numpy ë°°ì—´ë¡œ ë³€í™˜ëœë‹¤. ê·¸ëŸ° ë‹¤ìŒ ëª¨ë¸ì— ì „ì†¡ë˜ê³  ì˜ˆì¸¡ì´ ë°˜í™˜ëœë‹¤.

2. í‘œì‹œí•  êµ­ê°€ë“¤ì€ ì˜ˆì¸¡ëœ êµ­ê°€ ì½”ë“œì—ì„œ ì½ì„ ìˆ˜ ìˆëŠ” í…ìŠ¤íŠ¸ë¡œ ë‹¤ì‹œ ë Œë”ë§ë˜ë©°, í•´ë‹¹ ê°’ì€ í…œí”Œë¦¿ì—ì„œ ë Œë”ë§í•˜ê¸° ìœ„í•´ index.htmlë¡œ ë³´ë‚´ì§„ë‹¤.



Flaskì™€ í”¼í´ëœ ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ì„ ì´ìš©í•˜ëŠ” ê²ƒì€ ë¹„êµì  ê°„ë‹¨í•˜ë‹¤. ê°€ì¥ ì–´ë ¤ìš´ ê²ƒì€ ì˜ˆì¸¡ì„ ì–»ê¸° ìœ„í•´ ëª¨ë¸ì— ì „ì†¡í•´ì•¼ í•˜ëŠ” ë°ì´í„°ì˜ í˜•íƒœë¥¼ ì´í•´í•˜ëŠ” ê²ƒì´ë‹¤. ì´ê²ƒì€ ëª¨ë¸ì´ ì–´ë–»ê²Œ í›ˆë ¨ë˜ì—ˆëŠ”ì§€ì— ë”°ë¼ ë‹¬ë¼ì§„ë‹¤. ì´ ëª¨ë¸ì€ ì˜ˆì¸¡ì„ ì–»ê¸° ìœ„í•´ ì„¸ ê°œì˜ ë°ì´í„° í¬ì¸íŠ¸ë¥¼ ì…ë ¥í•´ì•¼ í•œë‹¤.



ì „ë¬¸ì ì¸ ì„¤ì •ì—ì„œëŠ” ëª¨ë¸ì„ í›ˆë ¨í•˜ëŠ” ì‚¬ëŒê³¼ ì›¹ ë˜ëŠ” ëª¨ë°”ì¼ ì•±ì—ì„œ ì‚¬ìš©í•˜ëŠ” ì‚¬ëŒ ì‚¬ì´ì— ì¢‹ì€ ì˜ì‚¬ ì†Œí†µì´ í•„ìš”í•œ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. ìš°ë¦¬ì˜ ê²½ìš°, ì´ ì¼ì„ í•˜ëŠ” ì‚¬ëŒì€ ë‹¨ í•œ ëª…, ì¦‰, ë³¸ì¸ì´ë‹¤.

